<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÚ¯Ø± Ù‚ÛŒÙ…Øª Ù¾Ø§Ø±Ú†Ù‡</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f7f8fa;
      color: #333;
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      direction: rtl;
    }
    h1 { text-align: center; color: #444; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      margin-top: 15px;
      padding: 10px;
      width: 100%;
      background: #0078d7;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover { background: #005fa3; }
    .result {
      margin-top: 20px;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .keshbaf-item {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÚ¯Ø± Ù‚ÛŒÙ…Øª Ù¾Ø§Ø±Ú†Ù‡</h1>

  <label>Ù‚ÛŒÙ…Øª Ù‡Ø± Ù…ØªØ± Ù¾Ø§Ø±Ú†Ù‡:</label>
  <input type="number" id="tool" step="any" />

  <label>Ø¹Ø±Ø¶ Ù¾Ø§Ø±Ú†Ù‡:</label>
  <input type="number" id="arz" step="any" />

  <label>Ø·ÙˆÙ„ Ù¾Ø§Ø±Ú†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡:</label>
  <input type="number" id="toole" step="any" />

  <label>Ø¹Ø±Ø¶ Ù¾Ø§Ø±Ú†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡:</label>
  <input type="number" id="arze" step="any" />

  <h3>Ø¢Ø³ØªÛŒÙ†</h3>
  <label>Ø·ÙˆÙ„ Ø¢Ø³ØªÛŒÙ†:</label>
  <input type="number" id="astin" step="any" />
  <label>Ø¹Ø±Ø¶ Ø¢Ø³ØªÛŒÙ†:</label>
  <input type="number" id="astinarz" step="any" />

  <hr>

  <h3>Ú©Ù„Ø§Ù‡</h3>
  <label>Ø¢ÛŒØ§ Ú©Ù„Ø§Ù‡ Ø¯Ø§Ø±Ø¯ØŸ (Ø¨Ù„Ù‡ = 0ØŒ Ø®ÛŒØ± = 1)</label>
  <input type="number" id="hasKolah" min="0" max="1" step="1" value="1" />
  <div id="kolahInputs" style="display:none;">
    <label>Ø·ÙˆÙ„ Ù¾Ø§Ø±Ú†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ú©Ù„Ø§Ù‡:</label>
    <input type="number" id="tkolah" step="any" />
    <label>Ø¹Ø±Ø¶ Ù¾Ø§Ø±Ú†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ú©Ù„Ø§Ù‡:</label>
    <input type="number" id="akolah" step="any" />
  </div>

  <hr>

  <h3>Ú©Ø´Ø¨Ø§Ùâ€ŒÙ‡Ø§</h3>
  <button type="button" onclick="addKeshbaf()">â• Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø´Ø¨Ø§Ù</button>
  <div id="keshbafContainer"></div>

  <hr>

  <label>Ù‚ÛŒÙ…Øª Ø¨Ø±Ú†Ø³Ø¨:</label>
  <input type="number" id="barchasb" step="any" />

  <label>Ù‚ÛŒÙ…Øª Ø¯ÙˆØ®Øª:</label>
  <input type="number" id="dookht" step="any" />

  <button onclick="calculate()">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ù‡Ø§ÛŒÛŒ</button>

  <div id="result" class="result"></div>

  <script>
    const keshbafContainer = document.getElementById('keshbafContainer');
    const kolahToggle = document.getElementById('hasKolah');
    const kolahInputs = document.getElementById('kolahInputs');
    let keshbafCount = 0;

    kolahToggle.addEventListener('input', () => {
      kolahInputs.style.display = kolahToggle.value == 0 ? 'block' : 'none';
    });

    function addKeshbaf() {
      keshbafCount++;
      const div = document.createElement('div');
      div.className = 'keshbaf-item';
      div.innerHTML = `
        <h4>Ú©Ø´Ø¨Ø§Ù ${keshbafCount}</h4>
        <label>Ø·ÙˆÙ„ Ú©Ø´Ø¨Ø§Ù:</label>
        <input type="number" id="keshbafe_${keshbafCount}" step="any" />
        <label>Ø¹Ø±Ø¶ Ú©Ø´Ø¨Ø§Ù:</label>
        <input type="number" id="keshbafearz_${keshbafCount}" step="any" />
        <button type="button" onclick="removeKeshbaf(this)">âŒ Ø­Ø°Ù</button>
      `;
      keshbafContainer.appendChild(div);
    }

    function removeKeshbaf(btn) {
      btn.parentElement.remove();
    }

    function calculate() {
      let tool = parseFloat(document.getElementById('tool').value) || 0;
      let arz = parseFloat(document.getElementById('arz').value) || 0;
      let toole = parseFloat(document.getElementById('toole').value) || 0;
      let arze = parseFloat(document.getElementById('arze').value) || 0;
      let astin = parseFloat(document.getElementById('astin').value) || 0;
      let astinarz = parseFloat(document.getElementById('astinarz').value) || 0;

      // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¢Ø³ØªÛŒÙ† (Ø¬Ø¯ÛŒØ¯)
      let astinGheymat = (astin * tool) * (astinarz / arz);

      // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù„Ø§Ù‡ (Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯)
      let kolah = 0;
      if (parseInt(document.getElementById('hasKolah').value) === 0) {
        let tkolah = parseFloat(document.getElementById('tkolah').value) || 0;
        let akolah = parseFloat(document.getElementById('akolah').value) || 0;
        kolah = (tkolah * tool) * (akolah / arz);
      }

      // Ù‚ÛŒÙ…Øª Ù¾Ø§Ø±Ú†Ù‡ Ø§ØµÙ„ÛŒ
      let ghimatParche = (toole * tool) * (arze / arz) + astinGheymat + kolah;

      // Ø¬Ù…Ø¹ ØªÙ…Ø§Ù… Ú©Ø´Ø¨Ø§Ùâ€ŒÙ‡Ø§
      let keshbaf = 0;
      const items = document.querySelectorAll('.keshbaf-item');
      items.forEach((item) => {
        const keshbafe = parseFloat(item.querySelector(`[id^="keshbafe_"]`).value) || 0;
        const keshbafearz = parseFloat(item.querySelector(`[id^="keshbafearz_"]`).value) || 0;
        keshbaf += (360 * keshbafe) * (keshbafearz / 0.63);
      });

      ghimatParche += keshbaf;

      // Ø¨Ø±Ú†Ø³Ø¨ Ùˆ Ø¯ÙˆØ®Øª
      let barchasb = parseFloat(document.getElementById('barchasb').value) || 0;
      if (barchasb !== 0) {
        barchasb = (barchasb * 1.2) + 5;
      }

      let dookht = parseFloat(document.getElementById('dookht').value) || 0;
      let total = dookht + barchasb + ghimatParche;

      document.getElementById('result').innerHTML = `
        <p><strong>Ù‚ÛŒÙ…Øª Ù¾Ø§Ø±Ú†Ù‡:</strong> ${ghimatParche.toFixed(2)}</p>
        <p><strong>Ù‚ÛŒÙ…Øª Ú©Ù„:</strong> ${total.toFixed(2)}</p>
        <p>ğŸ”¹ ØªØ¹Ø¯Ø§Ø¯ Ú©Ø´Ø¨Ø§Ùâ€ŒÙ‡Ø§: ${items.length}</p>
        <p>ğŸ© Ú©Ù„Ø§Ù‡: ${kolah > 0 ? kolah.toFixed(2) + ' (Ø¯Ø§Ø±Ø¯)' : 'Ù†Ø¯Ø§Ø±Ø¯'}</p>
        <p>ğŸ‘• Ø¢Ø³ØªÛŒÙ†: ${astinGheymat.toFixed(2)}</p>
      `;
    }
  </script>
</body>
</html>
