<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÚ¯Ø± Ù‚ÛŒÙ…Øª Ù¾Ø§Ø±Ú†Ù‡</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f7f8fa;
      color: #333;
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      direction: rtl;
    }

    h1 {
      text-align: center;
      color: #444;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      margin-top: 15px;
      padding: 10px;
      width: 100%;
      background: #0078d7;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover {
      background: #005fa3;
    }

    .result {
      margin-top: 20px;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .keshbaf-item {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      margin-top: 10px;
    }
  </style>
</head>

<body>

  <h1>Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÚ¯Ø± Ù‚ÛŒÙ…Øª Ù¾Ø§Ø±Ú†Ù‡</h1>

  <label>Ù‚ÛŒÙ…Øª Ù‡Ø± Ù…ØªØ± Ù¾Ø§Ø±Ú†Ù‡:</label>
  <input type="number" id="tool" step="any" />

  <label>Ø¹Ø±Ø¶ Ù¾Ø§Ø±Ú†Ù‡:</label>
  <input type="number" id="arz" step="any" />

  <label>Ø·ÙˆÙ„ Ù¾Ø§Ø±Ú†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡:</label>
  <input type="number" id="toole" step="any" />

  <label>Ø¹Ø±Ø¶ Ù¾Ø§Ø±Ú†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡:</label>
  <input type="number" id="arze" step="any" />

  <h3>Ø¢Ø³ØªÛŒÙ†</h3>
  <label>Ø·ÙˆÙ„ Ø¢Ø³ØªÛŒÙ†:</label>
  <input type="number" id="astin" step="any" />

  <label>Ø¹Ø±Ø¶ Ø¢Ø³ØªÛŒÙ†:</label>
  <input type="number" id="astinarz" step="any" />

  <hr>

  <h3>Ú©Ù„Ø§Ù‡</h3>
  <label>Ø¢ÛŒØ§ Ú©Ù„Ø§Ù‡ Ø¯Ø§Ø±Ø¯ØŸ (Ø¨Ù„Ù‡ = 0ØŒ Ø®ÛŒØ± = 1)</label>
  <input type="number" id="hasKolah" value="1" min="0" max="1">

  <div id="kolahInputs" style="display:none;">
    <label>Ø·ÙˆÙ„ Ù¾Ø§Ø±Ú†Ù‡ Ú©Ù„Ø§Ù‡:</label>
    <input type="number" id="tkolah" step="any">

    <label>Ø¹Ø±Ø¶ Ù¾Ø§Ø±Ú†Ù‡ Ú©Ù„Ø§Ù‡:</label>
    <input type="number" id="akolah" step="any">
  </div>

  <hr>

  <label>Ù‚ÛŒÙ…Øª Ù¾Ø§ÛŒÙ‡ Ú©Ø´Ø¨Ø§Ù (Ù‡Ø± Ù…ØªØ±):</label>
  <input type="number" id="keshbafPrice" step="any">

  <h3>Ú©Ø´Ø¨Ø§Ùâ€ŒÙ‡Ø§</h3>
  <button type="button" onclick="addKeshbaf()">â• Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø´Ø¨Ø§Ù</button>
  <div id="keshbafContainer"></div>

  <hr>

  <label>Ù‚ÛŒÙ…Øª Ø¨Ø±Ú†Ø³Ø¨:</label>
  <input type="number" id="barchasb" step="any">

  <label>Ù‚ÛŒÙ…Øª Ø¯ÙˆØ®Øª:</label>
  <input type="number" id="dookht" step="any">

  <button onclick="calculate()">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ù‡Ø§ÛŒÛŒ</button>

  <div id="result" class="result"></div>

  <script>
    const keshbafContainer = document.getElementById('keshbafContainer');
    const kolahToggle = document.getElementById('hasKolah');
    const kolahInputs = document.getElementById('kolahInputs');
    let keshbafCount = 0;

    kolahToggle.addEventListener('input', () => {
      kolahInputs.style.display = kolahToggle.value == 0 ? 'block' : 'none';
    });

    function addKeshbaf() {
      keshbafCount++;
      const div = document.createElement('div');
      div.className = 'keshbaf-item';
      div.innerHTML = `
        <h4>Ú©Ø´Ø¨Ø§Ù ${keshbafCount}</h4>
        <label>Ø·ÙˆÙ„ Ú©Ø´Ø¨Ø§Ù:</label>
        <input type="number" class="keshbafe" step="any">

        <label>Ø¹Ø±Ø¶ Ú©Ø´Ø¨Ø§Ù:</label>
        <input type="number" class="keshbafearz" step="any">

        <button type="button" onclick="this.parentElement.remove()">âŒ Ø­Ø°Ù</button>
      `;
      keshbafContainer.appendChild(div);
    }

    function calculate() {
      let tool = +document.getElementById('tool').value || 0;
      let arz = +document.getElementById('arz').value || 1;
      let toole = +document.getElementById('toole').value || 0;
      let arze = +document.getElementById('arze').value || 0;
      let astin = +document.getElementById('astin').value || 0;
      let astinarz = +document.getElementById('astinarz').value || 0;
      let keshbafPrice = +document.getElementById('keshbafPrice').value || 0;

      let astinPrice = (astin * tool) * (astinarz / arz);

      let kolahPrice = 0;
      if (kolahToggle.value == 0) {
        let tkolah = +document.getElementById('tkolah').value || 0;
        let akolah = +document.getElementById('akolah').value || 0;
        kolahPrice = (tkolah * tool) * (akolah / arz);
      }

      let parchePrice = (toole * tool) * (arze / arz) + astinPrice + kolahPrice;

      let keshbafTotalPrice = 0;
      document.querySelectorAll('.keshbaf-item').forEach(item => {
        let t = +item.querySelector('.keshbafe').value || 0;
        let a = +item.querySelector('.keshbafearz').value || 0;
        keshbafTotalPrice += (keshbafPrice * t) * (a / 0.63);
      });

      let barchasb = +document.getElementById('barchasb').value || 0;
      if (barchasb > 0) barchasb = (barchasb * 1.2) + 5;

      let dookht = +document.getElementById('dookht').value || 0;

      let total = parchePrice + keshbafTotalPrice + barchasb + dookht;

      document.getElementById('result').innerHTML = `
        <p><strong>Ù‚ÛŒÙ…Øª Ù¾Ø§Ø±Ú†Ù‡:</strong> ${parchePrice.toFixed(2)}</p>
        <p><strong>Ù‚ÛŒÙ…Øª Ú©Ø´Ø¨Ø§Ù:</strong> ${keshbafTotalPrice.toFixed(2)}</p>
        <p><strong>Ø¨Ø±Ú†Ø³Ø¨:</strong> ${barchasb.toFixed(2)}</p>
        <p><strong>Ø¯ÙˆØ®Øª:</strong> ${dookht.toFixed(2)}</p>
        <hr>
        <p><strong>ğŸ’° Ù‚ÛŒÙ…Øª Ú©Ù„:</strong> ${total.toFixed(2)}</p>
      `;
    }
  </script>

</body>
</html>
